<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>百家樂分析器</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 600px; margin: auto; padding: 20px; }
  h1 { text-align: center; }
  .section { margin-bottom: 20px; }
  input { width: 50px; margin-right: 5px; }
  button { margin-right: 10px; padding: 5px 10px; }
  select { padding: 5px; }
  .result { margin-top: 10px; font-weight: bold; }
</style>
</head>
<body>
<h1>百家樂分析器</h1>

<div class="section">
  <h3>輸入上一局牌（1=A，11/12/13=J/Q/K）</h3>
  <div>
    閒家: <input type="number" id="player1" min="1" max="13">
          <input type="number" id="player2" min="1" max="13">
          <input type="number" id="player3" min="1" max="13">
  </div>
  <div>
    莊家: <input type="number" id="banker1" min="1" max="13">
          <input type="number" id="banker2" min="1" max="13">
          <input type="number" id="banker3" min="1" max="13">
  </div>
</div>

<div class="section">
  <h3>上一局結果</h3>
  <select id="lastResult">
    <option value="">請選擇</option>
    <option value="banker">莊家勝</option>
    <option value="player">閒家勝</option>
    <option value="tie">和局</option>
  </select>
</div>

<div class="section">
  <button id="calculate">計算累計期望值</button>
  <button id="shuffle">洗牌 / 重新計算</button>
</div>

<div class="section">
  <div class="result" id="expectation">累計期望值：0</div>
  <div class="result" id="recommendation">推薦下注：-</div>
</div>

<script>
let totalExpectation = 0;

function convertCard(val) {
  // 保證輸入數值1~13
  val = parseInt(val);
  if (isNaN(val) || val < 1 || val > 13) return 0;
  return val;
}

function calculateExpectation(playerCards, bankerCards, lastResult) {
  // 簡單期望值示例：莊家略優
  let expectation = 0;
  if (lastResult === "banker") expectation = 1.06;
  else if (lastResult === "player") expectation = 0.94;
  else if (lastResult === "tie") expectation = 0;
  return expectation;
}

function recommendNext(totalExpectation) {
  // 簡單推薦：累計期望值正→莊，負→閒
  if (totalExpectation > 0) return "莊家";
  else if (totalExpectation < 0) return "閒家";
  else return "-";
}

document.getElementById("calculate").addEventListener("click", () => {
  let playerCards = [
    convertCard(document.getElementById("player1").value),
    convertCard(document.getElementById("player2").value),
    convertCard(document.getElementById("player3").value)
  ];
  let bankerCards = [
    convertCard(document.getElementById("banker1").value),
    convertCard(document.getElementById("banker2").value),
    convertCard(document.getElementById("banker3").value)
  ];
  let lastResult = document.getElementById("lastResult").value;
  if (!lastResult) { alert("請選擇上一局結果"); return; }

  let expectation = calculateExpectation(playerCards, bankerCards, lastResult);
  totalExpectation += expectation;

  document.getElementById("expectation").textContent = "累計期望值：" + totalExpectation.toFixed(2);
  document.getElementById("recommendation").textContent = "推薦下注：" + recommendNext(totalExpectation);
});

document.getElementById("shuffle").addEventListener("click", () => {
  totalExpectation = 0;
  document.getElementById("player1").value = "";
  document.getElementById("player2").value = "";
  document.getElementById("player3").value = "";
  document.getElementById("banker1").value = "";
  document.getElementById("banker2").value = "";
  document.getElementById("banker3").value = "";
  document.getElementById("lastResult").value = "";
  document.getElementById("expectation").textContent = "累計期望值：0";
  document.getElementById("recommendation").textContent = "推薦下注：-";
});
</script>

</body>
</html>
